<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout :: layout (~{::title}, ~{::head_css}, ~{::nav_content}, ~{::main_content}, ~{::scripts})}">

<head>
    <title th:text="${usuario.id > 0 ? 'Modificar Usuario' : 'Registrar Usuario'}">Registrar Usuario - RUBEN</title>

    <th:block th:fragment="head_css">
        <style>
            body { background-color: #f8f9fa; }
        </style>
    </th:block>
</head>

<body>

    <th:block th:fragment="nav_content">
        <div th:replace="~{layout :: navbar('usuarios')}"></div>
    </th:block>

    <th:block th:fragment="main_content">

    <div class="container mt-5 mb-5">

        <h2 class="text-center mb-4" th:text="${usuario.id > 0 ? 'Modificar Usuario' : 'Registro de Usuario'}">
            Registro de Usuario
        </h2>
        
        <div th:if="${errorDuplicado}" class="alert alert-warning alert-dismissible fade show" role="alert">
            <i class="bi bi-exclamation-triangle-fill"></i>
            <span th:text="${errorDuplicado}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>

        <form th:action="@{/guardarUsuario}" th:object="${usuario}" method="post" 
              class="border rounded p-4 bg-white shadow-sm">
            
            <input type="hidden" th:field="*{id}" /> 

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">Nombre</label>
                    <input type="text" th:field="*{nombre}" class="form-control" 
                           th:classappend="${#fields.hasErrors('nombre') ? 'is-invalid' : ''}" 
                           placeholder="Ej: Gabriela">
                    <span th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label class="form-label">Apellido</label>
                    <input type="text" th:field="*{apellido}" class="form-control" 
                           th:classappend="${#fields.hasErrors('apellido') ? 'is-invalid' : ''}" 
                           placeholder="Ej: Sánchez">
                    <span th:if="${#fields.hasErrors('apellido')}" th:errors="*{apellido}" class="text-danger"></span>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label class="form-label">Email</label>
                    <input type="email" th:field="*{email}" class="form-control" 
                           th:classappend="${#fields.hasErrors('email') ? 'is-invalid' : ''}" 
                           placeholder="Ej: gabriela@example.com">
                    <span th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="text-danger"></span>
                </div>
                <div class="col-md-6">
                    <label class="form-label">DNI</label>
                    <input type="text" th:field="*{dni}" class="form-control" 
                           th:classappend="${#fields.hasErrors('dni') ? 'is-invalid' : ''}" 
                           placeholder="Ej: 40321876">
                    <span th:if="${#fields.hasErrors('dni')}" th:errors="*{dni}" class="text-danger"></span>
                </div>
            </div>

            <div class="mb-4">
                <label class="form-label">Teléfono</label>
                <input type="text" th:field="*{telefono}" class="form-control" placeholder="Ej: 381-1234567">
                </div>
            
            <div class="text-center">
                <button type="submit" class="btn btn-success btn-lg">
                    <i th:class="${usuario.id > 0 ? 'bi bi-save' : 'bi bi-person-add'}"></i> 
                    <span th:text="${usuario.id > 0 ? 'Actualizar Usuario' : 'Guardar Usuario'}">Guardar</span>
                </button>
                <a href="/listaUsuarios" class="btn btn-secondary btn-lg ms-2">Cancelar</a>
            </div>
        </form>
    </div>

    </th:block>

    <th:block th:fragment="scripts"></th:block>

</body>
</html>