<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{layout :: layout (~{::title}, ~{::head_css}, ~{::nav_content}, ~{::main_content}, ~{::scripts})}">

<head>
	<title>Registrar Vehículo - RUBEN</title>

	<th:block th:fragment="head_css">
		<style>
			body { background-color: #f8f9fa; }
		</style>
	</th:block>
</head>

<body>

	<th:block th:fragment="nav_content">
		<div th:replace="~{layout :: navbar('vehiculos')}"></div>
	</th:block>

	<th:block th:fragment="main_content">

	<div class="container mt-5 mb-5">

		<h2 class="text-center mb-4" th:text="${vehiculo.id > 0 ? 'Modificar Vehículo' : 'Registro de Vehículo'}">
			Registro de Vehículo
		</h2>

		<div th:if="${errorPatente}" class="alert alert-warning alert-dismissible fade show" role="alert">
			<i class="bi bi-exclamation-triangle-fill"></i>
			<span th:text="${errorPatente}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
		</div>

		<form th:action="@{/guardarVehiculo}" th:object="${vehiculo}" method="post"
			  class="border rounded p-4 bg-white shadow-sm">

			<input type="hidden" th:field="*{id}" /> 

			<div class="row mb-3">
				<div class="col-md-6">
					<label class="form-label">Marca</label>
					<input type="text" th:field="*{marca}" class="form-control"
							th:classappend="${#fields.hasErrors('marca') ? 'is-invalid' : ''}"
							placeholder="Ej: Toyota">
					<span th:if="${#fields.hasErrors('marca')}" th:errors="*{marca}" class="text-danger"></span>
				</div>

				<div class="col-md-6">
					<label class="form-label">Modelo</label>
					<input type="text" th:field="*{modelo}" class="form-control"
							th:classappend="${#fields.hasErrors('modelo') ? 'is-invalid' : ''}"
							placeholder="Ej: Corolla">
					<span th:if="${#fields.hasErrors('modelo')}" th:errors="*{modelo}" class="text-danger"></span>
				</div>
			</div>

			<div class="row mb-3">
				<div class="col-md-4">
					<label class="form-label">Año</label>
					<input type="number" th:field="*{anio}" class="form-control"
							th:classappend="${#fields.hasErrors('anio') ? 'is-invalid' : ''}"
							placeholder="Ej: 2020">
					<span th:if="${#fields.hasErrors('anio')}" th:errors="*{anio}" class="text-danger"></span>
				</div>

				<div class="col-md-4">
                <label class="form-label">Color</label>
                <select th:field="*{color}" class="form-select"
                th:classappend="${#fields.hasErrors('color') ? 'is-invalid' : ''}">
                <option value="" disabled>Seleccionar...</option>
                <option value="Blanco">Blanco</option>
                <option value="Gris">Gris</option>
                <option value="Negro">Negro</option>
                <option value="Azul">Azul</option>
                <option value="Rojo">Rojo</option>
                <option value="Verde">Verde</option>
                <option value="Amarillo">Amarillo</option>
                </select>
                <span th:if="${#fields.hasErrors('color')}" th:errors="*{color}" class="text-danger"></span>
                </div>

				<div class="col-md-4">
					<label class="form-label">Patente</label>
					<input type="text" th:field="*{patente}" class="form-control"
							th:classappend="${#fields.hasErrors('patente') ? 'is-invalid' : ''}"
							placeholder="Ej: AB123CD">
					<span th:if="${#fields.hasErrors('patente')}" th:errors="*{patente}" class="text-danger"></span>
				</div>
			</div>

			<div class="row mb-4">
                <div class="col-md-6">
                    <label class="form-label">Tipo de Vehículo</label>
                    <select th:field="*{tipo}" class="form-select"
                            th:classappend="${#fields.hasErrors('tipo') ? 'is-invalid' : ''}">
                        <option value="">Seleccionar...</option>
                        <option value="X">X (Base)</option>
                        <option value="Luxe">Luxe</option>
                        <option value="Premium">Premium</option>
                    </select>
                    <span th:if="${#fields.hasErrors('tipo')}" th:errors="*{tipo}" class="text-danger"></span>
                </div>
                
                <div class="col-md-6">
                    <label class="form-label">Conductor Asignado</label>
                    <select th:field="*{conductor}" class="form-select">
    <option value="" disabled selected>--- Seleccione un Conductor ---</option>
    
    <option th:each="c : ${conductoresDisponibles}" 
            th:value="${c.id}" 
            th:text="${c.nombre + ' ' + c.apellido + ' (' + c.dni + ')'}"
            
            th:disabled="${c.vehiculo != null}"> </option>
</select>
                </div>
                </div>

			<div class="text-center">
    <button type="submit" class="btn btn-success btn-lg">
        <span th:text="${vehiculo.id > 0 ? 'Actualizar Vehículo' : 'Guardar Vehículo'}">Guardar vehiculo</span>
    </button>
				<a href="/" class="btn btn-secondary btn-lg ms-2">Volver al Inicio</a>
			</div>

		</form>
	</div>

</th:block>
	<th:block th:fragment="scripts"></th:block>

</body>
</html>